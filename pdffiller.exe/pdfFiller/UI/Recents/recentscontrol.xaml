<UserControl x:Class="pdfFiller.UI.Recents.RecentsControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:pdfFiller.UI.Recents"
             xmlns:prop="clr-namespace:pdfFiller.AttachedProperties"
             xmlns:utils="clr-namespace:pdfFiller.Utils.View"
             xmlns:md="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:converters="clr-namespace:pdfFiller.Converters"
             Background="White" Height="auto">
  <FrameworkElement.DataContext>
    <local:RecentsViewModel/>
  </FrameworkElement.DataContext>
  <FrameworkElement.Resources>
    <converters:FolderToNameConverter x:Key="folderToNameConverter"/>
    <converters:EmptyFolderToControlConverter x:Key="emptyFolderToControlConverter"/>
    <converters:BooleanVisibilityConverter x:Key="booleanVisibilityConverter"/>
  </FrameworkElement.Resources>
  <Grid VerticalAlignment="Center">
    <Grid.RowDefinitions>
      <RowDefinition Height="auto"/>
      <RowDefinition Height="auto"/>
    </Grid.RowDefinitions>
    <TextBlock Margin="8" Foreground="#444" Text="{DynamicResource recent_documents}"
               FontFamily="{DynamicResource Medium}" FontSize="9"/>
    <utils:ListViewSelectionItemChangedOnMouseUp Grid.Row="1" Height="170" HorizontalAlignment="Center" BorderThickness="0"
                                                 ScrollViewer.VerticalScrollBarVisibility="Disabled"
                                                 ScrollViewer.HorizontalScrollBarVisibility="Disabled" ItemsSource="{Binding Recents}">
      <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
          <WrapPanel Orientation="Horizontal"/>
        </ItemsPanelTemplate>
      </ItemsControl.ItemsPanel>
      <ItemsControl.ItemContainerStyle>
        <Style TargetType="{x:Type ListBoxItem}">
          <Setter Property="prop:ContextMenuAttachedProperties.IsRightClickContextMenu" Value="True"/>
          <Setter Property="FrameworkElement.ContextMenu" Value="{DynamicResource ActionsMenuStyle}"/>
          <Setter Property="prop:ListViewAttachedProperties.ItemClickCommandListBox"
                  Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}, Path=DataContext.RecentClickCommand}"/>
          <Setter Property="FrameworkElement.Cursor" Value="Hand"/>
          <Setter Property="Control.Template">
            <Setter.Value>
              <ControlTemplate>
                <md:Card Width="200" Height="150" Margin="8" md:ShadowAssist.ShadowDepth="Depth1" Background="#F9F9F9"
                         BorderBrush="Transparent">
                  <Grid>
                    <Grid.RowDefinitions>
                      <RowDefinition Height="*"/>
                      <RowDefinition Height="auto"/>
                    </Grid.RowDefinitions>
                    <Image Margin="0 16 0 0" Grid.RowSpan="2" Source="{Binding PreviewUrl}"/>
                    <Border x:Name="DataBorder" Grid.Row="1" Padding="13" Background="White" DockPanel.Dock="Bottom"
                            CornerRadius="0 0 4 4">
                      <StackPanel Orientation="Vertical" VerticalAlignment="Center" Height="30">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                          <Image Width="15" VerticalAlignment="Top" Source="/pdfFiller;component/Resources/Images/Projects/pdf.png"/>
                          <StackPanel Margin="8 0 0 0" VerticalAlignment="Center" Orientation="Vertical">
                            <TextBlock FontSize="12" VerticalAlignment="Center" TextWrapping="Wrap" MaxWidth="130" MaxHeight="20"
                                       Foreground="#222" TextTrimming="CharacterEllipsis" HorizontalAlignment="Left"
                                       FontFamily="{DynamicResource Medium}" Text="{Binding Name}"/>
                            <StackPanel Margin="0 4 0 0" Orientation="Horizontal">
                              <TextBlock Text="{DynamicResource last_opened}" Margin="0 0 4 0" VerticalAlignment="Center"
                                         FontFamily="{DynamicResource Light}" FontSize="10" Foreground="#A3A3A3"/>
                              <TextBlock FontFamily="{DynamicResource Light}" VerticalAlignment="Center" Foreground="Black" FontSize="10"
                                         Text="{Binding Date}"/>
                            </StackPanel>
                          </StackPanel>
                        </StackPanel>
                      </StackPanel>
                    </Border>
                  </Grid>
                </md:Card>
                <ControlTemplate.Triggers>
                  <Trigger Property="UIElement.IsMouseOver" Value="true">
                    <Setter TargetName="DataBorder" Property="Border.Background" Value="#fff9f2"/>
                  </Trigger>
                </ControlTemplate.Triggers>
              </ControlTemplate>
            </Setter.Value>
          </Setter>
        </Style>
      </ItemsControl.ItemContainerStyle>
    </utils:ListViewSelectionItemChangedOnMouseUp>
    <utils:Loader Grid.Row="1"
                  Visibility="{Binding IsLoading, Converter={StaticResource booleanVisibilityConverter}}"/>
  </Grid>
</UserControl>